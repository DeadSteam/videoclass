# Отчёт по разработке системы классификации видео

**Группа:** 423  
**Авторы:** Привалов, Лянко, Сафаров, Рунина

---

## Система классификации видео на базе датасета HowTo100M
### Категория: Holidays and Traditions
### Модель: Qwen2-VL (Zero-Shot и Few-Shot Learning)

---

## 1. Теоретическая база

### 1.1 Постановка задачи

Современные видеоданные содержат богатую информацию как о визуальных объектах, так и о динамике их взаимодействия во времени. **Задача видеоклассификации** заключается в автоматическом определении категории или типа действия, изображённого в видеоролике.

**Области применения:**
- Анализ пользовательских видео (YouTube, TikTok)
- Системы видеонаблюдения
- Медиапоиск и рекомендательные системы
- Автоматическая модерация контента
- Робототехника и автономные системы

**Цель работы:** Разработать систему классификации видео внутри категории "Holidays and Traditions" датасета HowTo100M для автоматического определения праздничной тематики видео.

### 1.2 Датасет HowTo100M

**HowTo100M** — один из крупнейших датасетов для мультимодального обучения (видео + текст), созданный исследователями из INRIA и DeepMind.

| Характеристика | Значение |
|----------------|----------|
| Общее количество видео | 1,238,911 |
| Количество видеоклипов | 136+ миллионов |
| Источник | YouTube (инструктажные видео) |
| Формат | Видео + субтитры + метаданные |

### 1.3 Категория Holidays and Traditions

В рамках данной работы используется категория **"Holidays and Traditions"**:

| Подкатегория | Количество видео | Описание |
|--------------|------------------|----------|
| Halloween | 10,658 | Тыквы, костюмы, декорации |
| Christmas | 8,192 | Ёлки, подарки, Санта |
| Easter | 3,342 | Пасхальные яйца, кролик |
| Gift Giving | 2,560 | Упаковка подарков |
| Valentines Day | 781 | Сердца, романтика |
| Thanksgiving | 683 | Индейка, осень |
| Saint Patrick's Day | 375 | Зелёный цвет, клевер |
| Mother's Day | 254 | Цветы, подарки маме |
| **Всего** | **27,837** | — |

### 1.4 Zero-Shot Learning

**Zero-Shot Learning** — метод машинного обучения, позволяющий классифицировать объекты без использования размеченных обучающих примеров целевых классов.

**Принцип работы:**
1. Модель обучена на большом корпусе пар "изображение-текст"
2. Для классификации создаются текстовые описания категорий
3. Изображение и описания преобразуются в векторные представления
4. Классификация выполняется по семантической близости

**Математическая формулировка:**

Вероятность принадлежности изображения $x$ к классу $y_i$:

$$P(y_i|x) = \frac{\exp(sim(f(x), g(y_i)) / \tau)}{\sum_{j=1}^{K} \exp(sim(f(x), g(y_j)) / \tau)}$$

где:
- $f(x)$ — визуальное представление изображения
- $g(y_i)$ — текстовое представление категории
- $sim$ — функция сходства (косинусная близость)
- $\tau$ — температурный параметр
- $K$ — количество классов

**Преимущества Zero-Shot:**
- Не требует размеченных данных для новых классов
- Быстрая адаптация к новым задачам
- Масштабируемость на большое число категорий
- Интерпретируемость через текстовые описания

### 1.5 Few-Shot Learning

**Few-Shot Learning** — метод машинного обучения, использующий небольшое количество примеров (обычно 1-10) для улучшения классификации.

**Принцип работы:**
1. Модели предоставляются примеры изображений с метками (support set)
2. Примеры включаются в промпт перед классификацией нового изображения
3. Модель использует примеры как контекст для лучшего понимания категорий
4. Классификация выполняется с учетом показанных примеров

**Преимущества Few-Shot:**
- Улучшает точность по сравнению с Zero-Shot
- Позволяет адаптироваться к специфике данных
- Требует минимальное количество примеров (5-10 на категорию)
- Комбинируется с Zero-Shot подходом

**В данной работе:**
- Используется 5 примеров на категорию (5-shot learning)
- Support set загружается один раз перед классификацией
- Примеры включаются в промпт для каждого тестового изображения
- Система автоматически переключается между Zero-Shot и Few-Shot режимами

### 1.6 Модель Qwen2-VL

**Qwen2-VL** (Qwen2 Vision-Language) — мультимодальная модель от Alibaba, способная понимать и анализировать изображения и видео.

**Архитектура:**

| Компонент | Описание |
|-----------|----------|
| Vision Encoder | ViT (Vision Transformer) для извлечения визуальных признаков |
| Language Model | Qwen2 LLM для генерации текста |
| Cross-Attention | Механизм связи визуальных и текстовых представлений |
| Размер модели | 2B / 7B параметров |

**Особенности Qwen2-VL:**
- Понимание контекста изображения
- Способность отвечать на вопросы об изображении
- Поддержка различных разрешений
- Мультиязычность

---

## 2. Описание разработанной системы

### 2.1 Архитектура системы

```
┌─────────────────────────────────────────────────────────────────────┐
│            HOLIDAYS VIDEO CLASSIFICATION SYSTEM                      │
│                     (Qwen2-VL Zero-Shot)                            │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                      INPUT DATA                              │    │
│  │  HowTo100M Dataset → Filter "Holidays and Traditions"       │    │
│  │  27,837 videos → Sample for classification                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                   DATA PREPROCESSING                         │    │
│  │  1. Load video metadata (HowTo100M_v1.csv)                  │    │
│  │  2. Filter by category_1 = "Holidays and Traditions"        │    │
│  │  3. Download YouTube thumbnails (visual representation)     │    │
│  │  4. Resize images to 384x384 pixels                         │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                    QWEN2-VL MODEL                            │    │
│  │  ┌─────────────────────────────────────────────────────┐    │    │
│  │  │  Vision Encoder (ViT)                               │    │    │
│  │  │  - Extract visual features from thumbnail           │    │    │
│  │  │  - Output: visual embeddings                        │    │    │
│  │  └─────────────────────────────────────────────────────┘    │    │
│  │                         │                                    │    │
│  │                         ▼                                    │    │
│  │  ┌─────────────────────────────────────────────────────┐    │    │
│  │  │  Language Model (Qwen2 LLM)                         │    │    │
│  │  │  - Process classification prompt                    │    │    │
│  │  │  - Generate category prediction                     │    │    │
│  │  └─────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                   CLASSIFICATION                             │    │
│  │  Prompt: "Look at this image and determine which holiday    │    │
│  │          category it belongs to: Halloween, Christmas,      │    │
│  │          Easter, Gift Giving, Valentines Day, Thanksgiving, │    │
│  │          Saint Patrick's Day, Mother's Day"                 │    │
│  │                                                              │    │
│  │  Output: Category name (e.g., "Halloween")                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                    EVALUATION                                │    │
│  │  - Accuracy, Top-K Accuracy                                 │    │
│  │  - Precision, Recall, F1-score                              │    │
│  │  - Confusion Matrix                                         │    │
│  │  - Per-class metrics                                        │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 Структура проекта

Проект организован в модульную структуру для улучшения читаемости и поддерживаемости кода:

```
videoclass/
├── main.py                  # Точка входа, парсинг аргументов
├── models.py                # Модели данных (ClassificationResult, ExperimentMetrics)
├── dataset.py               # Класс HolidaysDataset для работы с датасетом
├── classifier.py            # Класс Qwen2VLClassifier для классификации
├── metrics.py               # Функции вычисления метрик
├── experiment.py            # Функции запуска экспериментов и сохранения результатов
│
├── Report.md                # Данный отчёт
├── requirements.txt         # Зависимости Python
│
├── HowTo100M/               # Датасет (в .gitignore)
│   ├── HowTo100M_v1.csv     # Метаданные видео (1.2M записей)
│   ├── task_ids.csv         # Маппинг задач
│   ├── caption.json         # Субтитры видео
│   └── README.txt           # Описание датасета
│
├── results/                 # Результаты экспериментов
│   ├── holidays_qwen_*_metrics.json      # Метрики
│   └── holidays_qwen_*_predictions.json  # Предсказания
│
└── thumbnail_cache/         # Кэш загруженных изображений (в .gitignore)
    └── [hash]/[video_id].jpg
```

**Описание модулей:**

- **`main.py`** — точка входа в программу, содержит функцию `main()` для парсинга аргументов командной строки и запуска эксперимента
- **`models.py`** — определяет структуры данных:
  - `ClassificationResult` — результат классификации одного видео
  - `ExperimentMetrics` — метрики эксперимента
- **`dataset.py`** — класс `HolidaysDataset`:
  - Загрузка и фильтрация данных из CSV
  - Сэмплирование для few-shot обучения
  - Загрузка и кэширование миниатюр YouTube
- **`classifier.py`** — класс `Qwen2VLClassifier`:
  - Инициализация модели Qwen2-VL
  - Классификация изображений (zero-shot и few-shot)
  - Поддержка few-shot примеров в промпте
  - Парсинг ответов модели
- **`metrics.py`** — функция `compute_metrics()`:
  - Вычисление accuracy, precision, recall, F1-score
  - Построение confusion matrix
  - Top-K accuracy
- **`experiment.py`** — функции:
  - `run_experiment()` — запуск полного эксперимента
  - `save_results()` — сохранение результатов в JSON

Такая модульная структура обеспечивает:
- Разделение ответственности (separation of concerns)
- Легкость тестирования отдельных компонентов
- Возможность переиспользования модулей
- Улучшенную читаемость и поддерживаемость кода

### 2.3 Алгоритм классификации

#### 2.3.1 Загрузка и фильтрация данных (dataset.py)

```python
from dataset import HolidaysDataset

# Инициализация и загрузка датасета
dataset = HolidaysDataset(root_path="HowTo100M")
dataset.load()  # Загружает и фильтрует данные

# Получение подкатегорий с достаточным количеством данных
subcategories = dataset.get_subcategories()  # Автоматически фильтрует >= 50 видео

# Сэмплирование для few-shot обучения
support_df, query_df = dataset.sample_for_classification(
    subcategories=subcategories,
    n_samples=80,
    n_shot=5,
    random_state=42
)
```

#### 2.3.2 Загрузка визуальных данных (dataset.py)

```python
# Загрузка миниатюры с автоматическим кэшированием
thumbnail = dataset.download_thumbnail(video_id)

# Метод автоматически:
# 1. Проверяет кэш по хэшу video_id
# 2. Пробует разные URL форматы YouTube
# 3. Сохраняет в кэш для повторного использования
```

#### 2.3.3 Классификация с Qwen2-VL (classifier.py)

**Zero-Shot режим:**

```python
from classifier import Qwen2VLClassifier

# Инициализация классификатора
classifier = Qwen2VLClassifier(model_name="Qwen/Qwen2-VL-2B-Instruct")

# Zero-Shot классификация (без примеров)
predicted_label, confidence, top_k = classifier.classify_image(
    image=thumbnail,
    categories=subcategories,
    method="zero_shot"
)
```

**Few-Shot режим:**

```python
# Подготовка примеров (support set)
support_examples = [
    (image1, "Halloween"),
    (image2, "Halloween"),
    (image3, "Christmas"),
    # ... 5 примеров на категорию
]

# Few-Shot классификация (с примерами)
predicted_label, confidence, top_k = classifier.classify_image(
    image=thumbnail,
    categories=subcategories,
    method="few_shot",
    support_examples=support_examples
)

# Метод автоматически:
# 1. Включает примеры в промпт перед тестовым изображением
# 2. Формирует промпт с описаниями категорий и примерами
# 3. Подготавливает входные данные (все изображения)
# 4. Генерирует ответ через Qwen2-VL
# 5. Парсит ответ и сопоставляет с категориями
```

**Разница между режимами:**

- **Zero-Shot**: Модель классифицирует только по текстовым описаниям категорий
- **Few-Shot**: Модель видит примеры изображений каждой категории перед классификацией, что улучшает точность

#### 2.3.4 Запуск полного эксперимента (experiment.py)

```python
from experiment import run_experiment, save_results

# Запуск эксперимента с Few-Shot Learning
metrics, results = run_experiment(
    model_name="Qwen/Qwen2-VL-2B-Instruct",
    n_samples=80,        # Количество тестовых примеров
    n_shot=5,            # Количество примеров на категорию для Few-Shot
    top_categories=8,    # Количество категорий
    random_state=42      # Для воспроизводимости
)

# Процесс:
# 1. Загружает датасет и фильтрует по категориям
# 2. Создает support set (5 примеров × 8 категорий = 40 примеров)
# 3. Создает query set (80 тестовых примеров)
# 4. Загружает миниатюры для support set
# 5. Для каждого query примера:
#    - Загружает миниатюру
#    - Классифицирует с использованием support примеров (Few-Shot)
# 6. Вычисляет метрики
# 7. Сохраняет результаты

# Сохранение результатов
save_results(metrics, results, output_dir="results")
```

#### 2.3.5 Использование из командной строки (main.py)

```bash
# Базовый запуск
python main.py

# С параметрами
python main.py --model Qwen/Qwen2-VL-2B-Instruct \
               --n_samples 100 \
               --categories 8 \
               --seed 42
```

### 2.4 Текстовые описания категорий

Для улучшения качества Zero-Shot классификации используются детальные описания:

| Категория | Ключевые признаки |
|-----------|-------------------|
| Halloween | Тыквы, костюмы, страшные декорации, оранжево-чёрная гамма |
| Christmas | Ёлка, Санта-Клаус, подарки, снег, зимние декорации |
| Easter | Пасхальные яйца, кролик, весенние украшения |
| Gift Giving | Упаковка подарков, ленты, коробки |
| Valentines Day | Сердца, романтика, красный/розовый цвет |
| Thanksgiving | Индейка, осенние декорации, урожай |
| Saint Patrick's Day | Зелёный цвет, клевер, ирландская тема |
| Mother's Day | Цветы, подарки для мамы, открытки |

### 2.5 Метрики оценки

| Метрика | Формула | Описание |
|---------|---------|----------|
| Accuracy | $\frac{TP + TN}{Total}$ | Доля правильных предсказаний |
| Precision | $\frac{TP}{TP + FP}$ | Точность положительных предсказаний |
| Recall | $\frac{TP}{TP + FN}$ | Полнота (чувствительность) |
| F1-Score | $2 \cdot \frac{Precision \cdot Recall}{Precision + Recall}$ | Гармоническое среднее |
| Top-K Accuracy | $\frac{\text{Correct in Top-K}}{Total}$ | Правильный класс в топ-K |

---

## 3. Результаты работы и тестирования системы

### 3.1 Конфигурация эксперимента

| Параметр | Значение |
|----------|----------|
| Модель | Qwen/Qwen2-VL-2B-Instruct |
| GPU | NVIDIA GeForce RTX 3060 (12 GB) |
| Память модели | 4.12 GB VRAM |
| Количество категорий | 8 |
| Тестовых примеров | 40 (5 на категорию) для сравнения |
| Support set | 40 примеров (5 на категорию) для Few-Shot |
| Визуальные данные | YouTube thumbnails (384×384) |

### 3.2 Сравнение Zero-Shot и Few-Shot Learning

Было проведено сравнение двух методов классификации на одинаковом наборе данных (40 тестовых примеров).

#### 3.2.1 Общие метрики

| Метрика | Zero-Shot | Few-Shot | Разница |
|---------|-----------|----------|---------|
| **Accuracy** | **52.50%** | **32.50%** | **-20.00%** |
| Top-3 Accuracy | 57.50% | 42.50% | -15.00% |
| Top-5 Accuracy | 72.50% | 62.50% | -10.00% |
| **Macro F1** | **50.89%** | **28.42%** | **-22.47%** |
| Macro Precision | 62.43% | 36.46% | -25.97% |
| Macro Recall | 52.50% | 32.50% | -20.00% |

**Вывод:** Zero-Shot Learning показал значительно лучшие результаты по всем метрикам.

#### 3.2.2 Результаты по категориям (F1-Score)

| Категория | Zero-Shot F1 | Few-Shot F1 | Разница |
|-----------|--------------|-------------|---------|
| **Halloween** | 60.00% | **75.00%** | **+15.00%** |
| **Easter** | 66.67% | 66.67% | 0.00% |
| Valentines Day | 60.00% | 57.14% | -2.86% |
| Christmas | 45.45% | 28.57% | -16.88% |
| Gift Giving | 66.67% | 0.00% | -66.67% |
| **Thanksgiving** | **75.00%** | 0.00% | -75.00% |
| Saint Patrick's Day | 33.33% | 0.00% | -33.33% |
| Mother's Day | 0.00% | 0.00% | 0.00% |

**Наблюдения:**
- **Halloween**: Few-Shot показал лучший результат (+15%)
- **Thanksgiving, Gift Giving, Saint Patrick's Day**: Few-Shot не смог классифицировать (F1 = 0%)
- **Easter**: Оба метода показали одинаковый результат
- В целом Zero-Shot более стабилен по всем категориям

#### 3.2.3 Анализ результатов

**Почему Zero-Shot показал лучшие результаты:**

1. **Перегрузка контекста**: При Few-Shot модели передается 40 примеров (5 × 8 категорий), что может перегружать контекст и мешать модели правильно классифицировать
2. **Качество примеров**: Support set может содержать нерепрезентативные примеры, которые вводят модель в заблуждение
3. **Архитектура модели**: Qwen2-VL может лучше работать с текстовыми описаниями, чем с большим количеством визуальных примеров в одном промпте
4. **Размер выборки**: При малом количестве тестовых примеров (5 на категорию) статистика может быть нестабильной

**Преимущества Zero-Shot:**
- Более стабильные результаты
- Не требует подготовки support set
- Быстрее работает (меньше изображений для обработки)
- Лучше работает с категориями, имеющими четкие визуальные признаки

**Когда Few-Shot может быть полезен:**
- При большем количестве примеров (10+ на категорию)
- При более тщательном отборе support примеров
- При использовании более крупной модели (7B вместо 2B)
- Для категорий с неочевидными признаками, где примеры помогают
- При использовании меньшего количества примеров (1-2 вместо 5) для уменьшения перегрузки контекста

**Выводы:**
1. Для данной задачи **Zero-Shot Learning является предпочтительным методом**
2. Few-Shot показал улучшение только для категории Halloween (+15%)
3. Необходимо дальнейшее исследование для оптимизации Few-Shot подхода
4. Результаты демонстрируют важность эмпирической проверки методов на конкретных данных

### 3.3 Детальные результаты Zero-Shot (основной эксперимент)

Для более полной оценки был проведен эксперимент на 80 примерах (10 на категорию) с использованием Zero-Shot метода.

### 3.3 Результаты по категориям

| Категория | Precision | Recall | F1-Score | Примеров |
|-----------|-----------|--------|----------|----------|
| **Halloween** | 77.78% | 70.00% | **73.68%** | 10 |
| **Thanksgiving** | 85.71% | 60.00% | **70.59%** | 10 |
| **Easter** | 75.00% | 60.00% | **66.67%** | 10 |
| Saint Patrick's Day | 80.00% | 40.00% | 53.33% | 10 |
| Valentines Day | 57.14% | 40.00% | 47.06% | 10 |
| Gift Giving | 75.00% | 30.00% | 42.86% | 10 |
| Mother's Day | 75.00% | 30.00% | 42.86% | 10 |
| Christmas | 25.00% | 90.00% | 39.13% | 10 |

### 3.4 Выводы по сравнению методов

**Рекомендации:**

1. **Для данной задачи предпочтительнее Zero-Shot Learning:**
   - Показывает более стабильные результаты
   - Проще в реализации и использовании
   - Быстрее работает

2. **Few-Shot Learning может быть полезен:**
   - Для специфических категорий (например, Halloween показал улучшение)
   - При наличии качественного, репрезентативного support set
   - При использовании более крупных моделей

3. **Возможные улучшения Few-Shot:**
   - Уменьшить количество примеров в support set (1-2 вместо 5)
   - Использовать только примеры из той же категории, что и тестовое изображение
   - Улучшить отбор примеров (выбирать наиболее репрезентативные)
   - Экспериментировать с форматом промпта

### 3.5 Confusion Matrix (Zero-Shot, 80 примеров)

```
                        ПРЕДСКАЗАННАЯ КАТЕГОРИЯ
                  Hall  Xmas  East  Gift  Val   Thnk  StPt  Mom
              ┌──────────────────────────────────────────────────┐
Halloween     │  7     3     0     0     0     0     0     0    │
Christmas     │  0     9     0     0     0     1     0     0    │
Easter        │  0     2     6     0     1     0     0     1    │
ИСТИННАЯ      │
КАТЕГОРИЯ Gift Giving │  0     6     0     3     0     0     1     0    │
Valentines    │  1     3     1     1     4     0     0     0    │
Thanksgiving  │  1     3     0     0     0     6     0     0    │
St Patrick's  │  0     5     1     0     0     0     4     0    │
Mother's Day  │  0     5     0     0     2     0     0     3    │
              └──────────────────────────────────────────────────┘
```

### 3.5 Визуализация результатов

#### 3.5.1 Распределение F1-Score по категориям

```
Halloween        ██████████████████████████████████████████████████████████  73.68%
Thanksgiving     ████████████████████████████████████████████████████████    70.59%
Easter           ██████████████████████████████████████████████████          66.67%
St Patrick's     ████████████████████████████████████████                    53.33%
Valentines Day   ███████████████████████████████████                         47.06%
Gift Giving      ██████████████████████████████                              42.86%
Mother's Day     ██████████████████████████████                              42.86%
Christmas        ███████████████████████████                                 39.13%
```

#### 3.5.2 Precision vs Recall

```
                 Precision    Recall
                 ─────────    ──────
Thanksgiving     ████████████████ 85.71%     ████████████ 60.00%
St Patrick's     ████████████████ 80.00%     ████████ 40.00%
Halloween        ███████████████  77.78%     ██████████████ 70.00%
Easter           ███████████████  75.00%     ████████████ 60.00%
Gift Giving      ███████████████  75.00%     ██████ 30.00%
Mother's Day     ███████████████  75.00%     ██████ 30.00%
Valentines       ███████████      57.14%     ████████ 40.00%
Christmas        █████            25.00%     ██████████████████ 90.00%
```

### 3.6 Анализ результатов

#### 3.6.1 Успешно классифицируемые категории

**Halloween (F1 = 73.68%):**
- Характерные визуальные признаки: тыквы, костюмы, оранжево-чёрная гамма
- Модель хорошо распознаёт уникальную тематику
- Precision 77.78% — высокая уверенность в предсказаниях

**Thanksgiving (F1 = 70.59%):**
- Узнаваемые элементы: осенняя тематика, индейка, декорации
- Высокий Precision (85.71%) — редко путается с другими категориями

**Easter (F1 = 66.67%):**
- Пасхальные яйца, весенняя цветовая гамма
- Сбалансированные Precision и Recall

#### 3.6.2 Проблемные категории

**Christmas (F1 = 39.13%):**
- Высокий Recall (90%) — модель часто предсказывает Christmas
- Низкий Precision (25%) — много ложноположительных срабатываний
- **Причина:** Christmas визуально доминирует в зимней/праздничной тематике

**Gift Giving / Mother's Day (F1 = 42.86%):**
- Низкий Recall (30%) — многие примеры пропускаются
- Причина: визуальное пересечение с другими праздниками (подарки есть на всех праздниках)

### 3.7 Выявленные закономерности

1. **Визуально уникальные категории классифицируются лучше:**
   - Halloween (тыквы, оранжевый)
   - Easter (пасхальные яйца, пастельные тона)
   - St. Patrick's Day (зелёный, клевер)

2. **Категории с пересекающимися признаками путаются:**
   - Gift Giving ↔ Christmas/Mother's Day (подарки)
   - Thanksgiving ↔ Christmas (зимняя тематика)

3. **Christmas доминирует в предсказаниях:**
   - 36 из 80 предсказаний — Christmas
   - Причина: наиболее распространённый праздник в обучающих данных модели

---

## 4. Выводы по работе

### 4.1 Основные достижения

1. **Разработана система классификации видео** в категории "Holidays and Traditions" датасета HowTo100M:
   - Использована модель **Qwen2-VL-2B-Instruct**
   - Реализован **Zero-Shot Learning** подход
   - Классификация по **8 подкатегориям** праздников

2. **Достигнутые показатели качества:**

   | Метрика | Значение |
   |---------|----------|
   | Accuracy | **52.50%** |
   | Macro F1 | **54.52%** |
   | Top-5 Accuracy | **78.75%** |
   | Лучшая категория | Halloween (73.68% F1) |

3. **Технические характеристики:**
   - Время обработки: ~1.5 сек/изображение на GPU
   - Использование памяти: 4.12 GB VRAM
   - Кэширование изображений для повторного использования

### 4.2 Преимущества разработанной системы

- **Zero-Shot подход:** Не требует обучения на целевых данных
- **Интерпретируемость:** Модель генерирует текстовые объяснения
- **Масштабируемость:** Легко добавить новые категории
- **Модульность:** Компоненты легко заменяемы

### 4.3 Ограничения и проблемы

1. **Дисбаланс предсказаний:**
   - Модель склонна предсказывать Christmas
   - Необходима калибровка или пост-обработка

2. **Пересечение категорий:**
   - Gift Giving пересекается со всеми праздниками
   - Требуется уточнение описаний категорий

3. **Зависимость от качества thumbnail:**
   - Не все thumbnail репрезентативны
   - Некоторые видео недоступны на YouTube

### 4.4 Рекомендации по улучшению

1. **Увеличение данных:**
   - Использовать несколько кадров из видео
   - Добавить анализ субтитров

2. **Улучшение промптов:**
   - Добавить негативные примеры
   - Использовать few-shot примеры в промпте

3. **Использование более мощных моделей:**
   - Qwen2-VL-7B для повышения точности
   - Ensemble нескольких моделей

### 4.5 Практическое применение

Разработанная система может применяться для:
- Автоматической категоризации праздничного контента
- Рекомендательных систем (сезонный контент)
- Модерации и фильтрации видео
- Аналитики трендов в видеоконтенте

---

## 5. Использованные источники

### 5.1 Научные статьи

1. **Miech A., Zhukov D., Alayrac J.B., et al.** (2019). *HowTo100M: Learning a Text-Video Embedding by Watching Hundred Million Narrated Video Clips*. ICCV 2019.
   - URL: https://arxiv.org/abs/1906.03327

2. **Wang P., Bai S., Tan S., et al.** (2024). *Qwen2-VL: Enhancing Vision-Language Model's Perception of the World at Any Resolution*. 
   - URL: https://arxiv.org/abs/2409.12191

3. **Radford A., Kim J.W., et al.** (2021). *Learning Transferable Visual Models From Natural Language Supervision*. ICML 2021.
   - URL: https://arxiv.org/abs/2103.00020

4. **Dosovitskiy A., et al.** (2020). *An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale*. ICLR 2021.
   - URL: https://arxiv.org/abs/2010.11929

### 5.2 Датасеты

| Название | URL |
|----------|-----|
| HowTo100M | https://www.di.ens.fr/willow/research/howto100m/ |

### 5.3 Модели

| Модель | URL |
|--------|-----|
| Qwen2-VL-2B-Instruct | https://huggingface.co/Qwen/Qwen2-VL-2B-Instruct |
| Qwen2-VL-7B-Instruct | https://huggingface.co/Qwen/Qwen2-VL-7B-Instruct |

### 5.4 Библиотеки

| Библиотека | Версия | Назначение |
|------------|--------|------------|
| PyTorch | 2.5+ | Глубокое обучение |
| Transformers | 4.40+ | Загрузка моделей |
| Pillow | 10.0+ | Обработка изображений |
| pandas | 2.0+ | Работа с данными |
| scikit-learn | 1.3+ | Метрики классификации |
| requests | 2.31+ | HTTP запросы |

---

## Приложение: Запуск системы

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск классификации

```bash
# Стандартный запуск
python main.py

# С параметрами
python main.py --model "Qwen/Qwen2-VL-2B-Instruct" --n_samples 100

# Использование 7B модели (требует >10GB VRAM)
python main.py --model "Qwen/Qwen2-VL-7B-Instruct" --n_samples 50
```

### Параметры командной строки

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `--model` | Модель Qwen2-VL | Qwen2-VL-2B-Instruct |
| `--n_samples` | Число тестовых примеров | 80 |
| `--categories` | Число категорий | 8 |
| `--seed` | Random seed | 42 |

---

*Отчёт подготовлен: Декабрь 2025*

*Система классификации видео на базе HowTo100M | Holidays*  
*Модель: Qwen2-VL | Метод: Zero-Shot Learning*
